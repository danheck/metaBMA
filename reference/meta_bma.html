<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Model Averaging for Meta-Analysis — meta_bma • metaBMA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Model Averaging for Meta-Analysis — meta_bma" />
<meta property="og:description" content="Fits random- and fixed-effects meta-analyses and performs Bayesian model
averaging for H1 (d != 0) vs. H0 (d = 0)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metaBMA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/metaBMA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/danheck/metaBMA/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Model Averaging for Meta-Analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/danheck/metaBMA/blob/master/R/meta_bma.R'><code>R/meta_bma.R</code></a></small>
    <div class="hidden name"><code>meta_bma.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits random- and fixed-effects meta-analyses and performs Bayesian model
averaging for H1 (d != 0) vs. H0 (d = 0).</p>
    </div>

    <pre class="usage"><span class='fu'>meta_bma</span><span class='op'>(</span>
  <span class='va'>y</span>,
  <span class='va'>SE</span>,
  <span class='va'>labels</span>,
  <span class='va'>data</span>,
  d <span class='op'>=</span> <span class='fu'><a href='prior.html'>prior</a></span><span class='op'>(</span><span class='st'>"cauchy"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>location <span class='op'>=</span> <span class='fl'>0</span>, scale <span class='op'>=</span> <span class='fl'>0.707</span><span class='op'>)</span><span class='op'>)</span>,
  tau <span class='op'>=</span> <span class='fu'><a href='prior.html'>prior</a></span><span class='op'>(</span><span class='st'>"invgamma"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>1</span>, scale <span class='op'>=</span> <span class='fl'>0.15</span><span class='op'>)</span><span class='op'>)</span>,
  rscale_contin <span class='op'>=</span> <span class='fl'>0.5</span>,
  rscale_discrete <span class='op'>=</span> <span class='fl'>0.707</span>,
  centering <span class='op'>=</span> <span class='cn'>TRUE</span>,
  prior <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,
  logml <span class='op'>=</span> <span class='st'>"integrate"</span>,
  summarize <span class='op'>=</span> <span class='st'>"stan"</span>,
  ci <span class='op'>=</span> <span class='fl'>0.95</span>,
  rel.tol <span class='op'>=</span> <span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span><span class='op'>^</span><span class='fl'>0.3</span>,
  logml_iter <span class='op'>=</span> <span class='fl'>5000</span>,
  silent_stan <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>effect size per study. Can be provided as (1) a numeric vector, (2)
the quoted or unquoted name of the variable in <code>data</code>, or (3) a
<code><a href='https://rdrr.io/r/stats/formula.html'>formula</a></code> to include discrete or continuous moderator
variables.</p></td>
    </tr>
    <tr>
      <th>SE</th>
      <td><p>standard error of effect size for each study. Can be a numeric
vector or the quoted or unquoted name of the variable in <code>data</code></p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>optional: character values with study labels. Can be a
character vector or the quoted or unquoted name of the variable in
<code>data</code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data frame containing the variables for effect size <code>y</code>,
standard error <code>SE</code>, <code>labels</code>, and moderators per study.</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p><code>prior</code> distribution on the average effect size <code>d</code>. The
prior probability density function is defined via <code><a href='prior.html'>prior</a></code>.</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p><code>prior</code> distribution on the between-study heterogeneity
<code>tau</code> (i.e., the standard deviation of the study effect sizes
<code>dstudy</code> in a random-effects meta-analysis. A (nonnegative) prior
probability density function is defined via <code><a href='prior.html'>prior</a></code>.</p></td>
    </tr>
    <tr>
      <th>rscale_contin</th>
      <td><p>scale parameter of the JZS prior for the continuous
covariates.</p></td>
    </tr>
    <tr>
      <th>rscale_discrete</th>
      <td><p>scale parameter of the JZS prior for discrete
moderators.</p></td>
    </tr>
    <tr>
      <th>centering</th>
      <td><p>whether continuous moderators are centered.</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>prior probabilities over models (possibly unnormalized) in the
order <code><a href='https://rdrr.io/r/base/c.html'>c(fixed_H0, fixed_H1, random_H0, random_H1)</a></code>. For instance, if
we expect fixed effects to be two times as likely as random effects and H0
and H1 to be equally likely: <code>prior = c(2,2,1,1)</code>.</p></td>
    </tr>
    <tr>
      <th>logml</th>
      <td><p>how to estimate the log-marginal likelihood: either by numerical
integration (<code>"integrate"</code>) or by bridge sampling using MCMC/Stan
samples (<code>"stan"</code>). To obtain high precision with <code>logml="stan"</code>,
many MCMC samples are required (e.g., <code>logml_iter=10000, warmup=1000</code>).</p></td>
    </tr>
    <tr>
      <th>summarize</th>
      <td><p>how to estimate parameter summaries (mean, median, SD,
etc.): Either by numerical integration (<code>summarize = "integrate"</code>) or
based on MCMC/Stan samples (<code>summarize = "stan"</code>).</p></td>
    </tr>
    <tr>
      <th>ci</th>
      <td><p>probability for the credibility/highest-density intervals.</p></td>
    </tr>
    <tr>
      <th>rel.tol</th>
      <td><p>relative tolerance used for numerical integration using
<code><a href='https://rdrr.io/r/stats/integrate.html'>integrate</a></code>. Use <code>rel.tol=.Machine$double.eps</code> for
maximal precision (however, this might be slow).</p></td>
    </tr>
    <tr>
      <th>logml_iter</th>
      <td><p>number of iterations (per chain) from the posterior
distribution of <code>d</code> and <code>tau</code>. The samples are used for computing
the marginal likelihood of the random-effects model with bridge sampling
(if <code>logml="stan"</code>) and for obtaining parameter estimates (if
<code>summarize="stan"</code>). Note that the argument <code>iter=2000</code> controls
the number of iterations for estimation of the random-effect parameters per
study in random-effects meta-analysis.</p></td>
    </tr>
    <tr>
      <th>silent_stan</th>
      <td><p>whether to suppress the Stan progress bar.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments passed to <code><a href='https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html'>rstan::sampling</a></code> (see
<code>stanmodel-method-sampling</code>). Relevant MCMC settings
concern the number of warmup samples that are discarded
(<code>warmup=500</code>), the total number of iterations per chain
(<code>iter=2000</code>), the number of MCMC chains (<code>chains=4</code>), whether
multiple cores should be used (<code>cores=4</code>), and control arguments that
make the sampling in Stan more robust, for instance:
<code>control=list(adapt_delta=.97)</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Bayesian model averaging for four meta-analysis models: Fixed- vs.
random-effects and H0 (\(d=0\)) vs. H1 (e.g., \(d&gt;0\)).
For a primer on Bayesian model-averaged meta-analysis,
see Gronau, Heck, Berkhout, Haaf, and Wagenmakers (2020).</p>
<p>By default, the log-marginal likelihood is computed by numerical integration
(<code>logml="integrate"</code>). This is relatively fast and gives precise,
reproducible results. However, for extreme priors or data (e.g., very small
standard errors), numerical integration is not robust and might provide
incorrect results. As an alternative, the log-marginal likelihood can be
estimated using MCMC/Stan samples and bridge sampling (<code>logml="stan"</code>).</p>
<p>To obtain posterior summary statistics for the average effect size <code>d</code>
and the heterogeneity parameter <code>tau</code>, one can also choose between
numerical integration (<code>summarize="integrate"</code>) or MCMC sampling in Stan
(<code>summarize="stan"</code>). If any moderators are included in a model, both
the marginal likelihood and posterior summary statistics can only be computed
using Stan.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gronau, Q. F., Erp, S. V., Heck, D. W., Cesario, J., Jonas, K. J., &amp; Wagenmakers, E.-J. (2017). A Bayesian model-averaged meta-analysis of the power pose effect with informed and default priors: the case of felt power. Comprehensive Results in Social Psychology, 2(1), 123-138. doi: <a href='https://doi.org/10.1080/23743603.2017.1326760'>10.1080/23743603.2017.1326760</a></p>
<p>Gronau, Q. F., Heck, D. W., Berkhout, S. W., Haaf, J. M., &amp; Wagenmakers, E.-J. (2020). A primer on Bayesian model-averaged meta-analysis. doi: <a href='https://doi.org/10.31234/osf.io/97qup'>10.31234/osf.io/97qup</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='meta_fixed.html'>meta_fixed</a>, <a href='meta_random.html'>meta_random</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'>### Bayesian Model-Averaged Meta-Analysis (H1: d&gt;0)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>towels</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>mb</span> <span class='op'>&lt;-</span> <span class='fu'>meta_bma</span><span class='op'>(</span><span class='va'>logOR</span>, <span class='va'>SE</span>, <span class='va'>study</span>, <span class='va'>towels</span>,
  d <span class='op'>=</span> <span class='fu'><a href='prior.html'>prior</a></span><span class='op'>(</span><span class='st'>"norm"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='fl'>.3</span><span class='op'>)</span>, lower <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
  tau <span class='op'>=</span> <span class='fu'><a href='prior.html'>prior</a></span><span class='op'>(</span><span class='st'>"invgamma"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>1</span>, scale <span class='op'>=</span> <span class='fl'>0.15</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>mb</span>
</div><div class='output co'>#&gt; ### Meta-Analysis with Bayesian Model Averaging ###
#&gt;    Fixed H0:  d = 0 
#&gt;    Fixed H1:  d ~ 'norm' (mean=0, sd=0.3) truncated to the interval [0,Inf]. 
#&gt;    Random H0: d   = 0,   
#&gt;               tau ~  'invgamma' (shape=1, scale=0.15) with support on the interval [0,Inf]. 
#&gt;    Random H1: d   ~ 'norm' (mean=0, sd=0.3) truncated to the interval [0,Inf]. 
#&gt;               tau ~ 'invgamma' (shape=1, scale=0.15) with support on the interval [0,Inf]. 
#&gt; 
#&gt; # Bayes factors:
#&gt;            (denominator)
#&gt; (numerator) fixed_H0 fixed_H1 random_H0 random_H1
#&gt;   fixed_H0      1.00   0.0419     0.372    0.0975
#&gt;   fixed_H1     23.87   1.0000     8.872    2.3259
#&gt;   random_H0     2.69   0.1127     1.000    0.2622
#&gt;   random_H1    10.26   0.4299     3.815    1.0000
#&gt; 
#&gt; # Bayesian Model Averaging
#&gt;   Comparison: (fixed_H1 &amp; random_H1) vs. (fixed_H0 &amp; random_H0)
#&gt;   Inclusion Bayes factor: 9.249 
#&gt;   Inclusion posterior probability: 0.902 
#&gt; 
#&gt; # Model posterior probabilities:
#&gt;           prior posterior logml
#&gt; fixed_H0   0.25    0.0264 -5.58
#&gt; fixed_H1   0.25    0.6311 -2.40
#&gt; random_H0  0.25    0.0711 -4.59
#&gt; random_H1  0.25    0.2713 -3.25
#&gt; 
#&gt; # Posterior summary statistics of average effect size:
#&gt;           mean    sd  2.5%   50% 97.5% hpd95_lower hpd95_upper  n_eff  Rhat
#&gt; averaged 0.207 0.080 0.049 0.207 0.364       0.045       0.360     NA    NA
#&gt; fixed    0.215 0.075 0.070 0.215 0.364       0.073       0.365 2083.6 1.001
#&gt; random   0.194 0.088 0.026 0.192 0.370       0.017       0.356 4692.6 1.001</div><div class='input'><span class='fu'><a href='plot_posterior.html'>plot_posterior</a></span><span class='op'>(</span><span class='va'>mb</span>, <span class='st'>"d"</span><span class='op'>)</span>
</div><div class='img'><img src='meta_bma-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel W. Heck.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


